/**
 * ****************************************************
 * @Copyright (c) 2018, Spell Master.
 * @version 1.0
 * @requires  Navegador compatível com HTML 5
 * ****************************************************
 * @class Executa ajax para processamento de arquivos.
 * ****************************************************
 */
var FileTransfer=function(){var e,n,o,r,t,s,l,i,d,a,c,u,p=[];function v(){(s=document.createElement("div")).id="transfer-progress",s.innerHTML='<div class="progress-text"></div><div class="progress-file"></div><div class="progress-percent"></div><div class="progress-line"><div class="progress-bar"></div></div>',r&&(s.innerHTML+='<button class="progress-cancel">Cancelar</button>',s.querySelector(".progress-cancel").addEventListener("click",q,!1)),document.body.appendChild(s)}function f(){"upload"===t?s.querySelector(".progress-text").innerText="Enviando Arquivo":"download"===t&&(s.querySelector(".progress-text").innerText="Transferindo Arquivo"),s.querySelector(".progress-file").innerText=o,p[0]=s.querySelector(".progress-percent"),p[1]=s.querySelector(".progress-bar")}function m(e){var n;e.lengthComputable&&(n=Math.round(e.loaded/e.total*100),p[0].innerText=n+"% completado",p[1].style.width=n+"%")}function g(){404===e.status?(console.log("Não foi possível localizar o arquivo ("+o+")"),q()):4===e.readyState&&200===e.status&&(r&&(s.querySelector(".progress-cancel").style.display="none"),setTimeout(function(){i&&(a=e.responseText,function(){var n=document.getElementById(i);if(null!==n){n.innerHTML=e.responseText;for(var o,r,t,s,l=a.indexOf("<script",0);-1!=l;)o=document.createElement("script"),r=a.indexOf(" src",l),l=a.indexOf(">",l)+1,r<l&&r>=0?(l=r+4,t=a.indexOf(".js",l)+3,s=(s=a.substring(l,t)).replace("=","").replace('"',"").replace(">",""),o.src=s):(t=a.indexOf("<\/script>",l),s=a.substring(l,t),o.innerText=s),l=a.indexOf("<script",t),n.appendChild(o);var d,c=n.getElementsByTagName("script");for(d=c.length-1;d>=0;d--)c[d].parentNode.removeChild(c[d])}else console.warn('Não é possível determinar sucesso do envio, elemento de #ID de validação é "null"')}()),"upload"===t?y():"download"===t&&(c=window.URL.createObjectURL(e.response),(u=document.createElement("a")).href=n,u.download=o,document.body.appendChild(u),u.click(),y())},1e3))}function y(){r&&s.querySelector(".progress-cancel").removeEventListener("click",q),"download"===t&&c&&(window.URL.revokeObjectURL(c),document.body.removeChild(u)),document.body.removeChild(s),x()}function x(){"upload"===t?(l=null,i=null,d=null):"download"===t&&(c=null,u=null),e=null,n=null,o=null,r=null,t=null,s=null,p=[]}function q(){e.abort(),y()}this.upload=function(s,a,c,u){return s?a?e instanceof XMLHttpRequest?console.log("Já existe um processo em andamento"):(e=new XMLHttpRequest,l=new FormData,r=!!u||null,i=c||null,t="upload",(d=document.getElementById(s).querySelector('input[type="file"]')).value?(n=d.files[0],o=n.name,l.append(d.name,n),v(),f(),e.upload.addEventListener("progress",m,!1),e.addEventListener("readystatechange",g,!1),e.responseType="text",e.open("POST","action.php",!0),e.send(l)):(x(),console.log("Nenhum arquivo selecionado"))):console.log("Arquivo de recebimento não expecificado"):console.log("ID do formulário não expecificado"),!1},this.download=function(s,l){if(s)if(e instanceof XMLHttpRequest)console.log("Já existe um processo em andamento");else{e=new XMLHttpRequest;var i=s.split("/").reverse();n=s,o=i[0],r=l||!1,t="download",v(),f(),e.addEventListener("progress",m,!1),e.addEventListener("readystatechange",g,!1),e.responseType="blob",e.open("GET",s,!0),e.send()}else console.log("Arquivo de envio não expecificado");return!1}};